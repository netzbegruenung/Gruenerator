/**
 * Scanner Page Styles - Delightful Zen Scanner
 * Ultra-minimal design with memorable micro-interactions
 *
 * Uses shared components: FormCard, SubmitButton, CopyButton
 * Custom styles for zen aesthetics and animations
 */

/* ========================================
   Base Layout
   ======================================== */

/* Prevent content-wrapper from forcing scroll when scanner is shown */
.content-wrapper:has(.scanner-page) {
  min-height: 0 !important;
  margin-bottom: 0;
  height: calc(100dvh - var(--safe-area-top, 0px));
  overflow-y: auto;
}

/* Hide header chrome when results are showing to maximise content space */
.scanner-layout:has(.scanner-results-state) .scanner-page-header,
.scanner-layout:has(.scanner-results-state) .scanner-result-meta {
  display: none;
}

/* Prevent footer from adding height on scanner page */
.app-content:has(.scanner-page) .footer {
  display: none;
}

.scanner-page {
  position: relative;
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  overflow: clip;
}

/* Dot grid is now a React component (DotGrid.tsx) */

/* Push header to top, center content in remaining space */
.scanner-layout {
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  overflow-x: clip;
  min-height: 0;
  height: 100%;
}

/* Header section - top centered */
.scanner-zen-header {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  gap: var(--spacing-small);
  padding-bottom: var(--spacing-large);
}

.scanner-zen-title {
  margin: 0;
  font-size: 2.2rem;
  font-weight: 600;
  color: var(--font-color);
}

.scanner-zen-subtitle {
  font-size: 1rem;
  color: var(--font-color);
  margin: 0;
  font-weight: 400;
  line-height: 1.5;
}

/* File type & size badges */
.scanner-badges {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: var(--spacing-small);
  margin-top: var(--spacing-small);
}

.scanner-badge {
  display: inline-block;
  padding: 4px 12px;
  font-size: 0.75rem;
  font-weight: 500;
  color: var(--font-color);
  background: transparent;
  border: 1px solid var(--grey-300);
  border-radius: 16px;
  white-space: nowrap;
  letter-spacing: 0.02em;
}

[data-theme="dark"] .scanner-badge {
  border-color: var(--grey-600);
}


@media (max-width: 768px) {
  .scanner-zen-title {
    font-size: 1.8rem;
  }

  .scanner-zen-subtitle {
    font-size: 0.9375rem;
  }
}

@media (max-width: 480px) {
  .scanner-zen-title {
    font-size: 1.5rem;
  }
}

/* ========================================
   Upload Zone — Apple-Inspired Card
   ======================================== */

.scanner-upload-zone {
  position: relative;
  background: transparent;
  border: none;
  border-radius: 20px;
  padding: 64px 48px;
  text-align: center;
  cursor: pointer;
}

.scanner-upload-zone:focus {
  outline: none;
}

.scanner-upload-zone:focus-visible {
  outline: 2px solid var(--primary);
  outline-offset: 4px;
  border-radius: 50%;
}

/* Remove all crop mark pseudo-elements */
.scanner-upload-zone::before,
.scanner-upload-zone::after,
.scanner-upload-content::before,
.scanner-upload-content::after {
  content: none;
}

/* Hover — icon circle changes color, icon stays light */
.scanner-upload-icon-circle:hover {
  background: var(--primary);
  color: var(--white);
}

/* Drag-over — icon circle turns green to signal drop target */
.scanner-tab-content.drag-over .scanner-upload-icon-circle {
  background: var(--primary);
  color: var(--white);
}

/* Dark mode icon circle */
[data-theme="dark"] .scanner-upload-icon-circle {
  background: var(--grey-800);
}

[data-theme="dark"] .scanner-upload-icon-circle:hover {
  background: var(--primary-900, rgba(95, 133, 117, 0.2));
}

.scanner-file-input {
  display: none;
}

/* ========================================
   Upload Content
   ======================================== */

.scanner-upload-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--spacing-small);
}

.scanner-upload-icon {
  width: 80px;
  height: 80px;
  color: var(--font-color);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: color 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

.scanner-upload-icon-circle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: var(--grey-100);
  transition: background 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

.scanner-upload-icon svg {
  width: 40px;
  height: 40px;
}

.scanner-upload-text {
  font-size: 1rem;
  color: var(--grey-500);
  margin: 0;
  font-weight: 500;
}

.scanner-upload-text span {
  color: var(--primary);
  text-decoration: none;
  border-bottom: 1px solid var(--primary-300);
  transition: border-color 0.2s ease;
}

.scanner-upload-text span:hover {
  border-bottom-color: var(--primary);
}

.scanner-upload-hint {
  font-size: 0.8125rem;
  color: var(--font-color-disabled);
  margin: 0;
  font-weight: 400;
}

/* ========================================
   Ready State - File Selected
   ======================================== */

.scanner-ready-state {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-large);
}

.scanner-selected-file {
  display: flex;
  align-items: center;
  gap: var(--spacing-medium);
  padding: var(--spacing-medium);
  background: var(--background-color);
  border: var(--border-subtle);
  border-radius: var(--card-border-radius-large);
}

.scanner-file-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 56px;
  height: 56px;
  background: var(--primary-50);
  color: var(--primary);
  border-radius: var(--card-border-radius-medium);
  flex-shrink: 0;
}

.scanner-file-icon svg {
  width: 32px;
  height: 32px;
}

.scanner-file-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 2px;
  min-width: 0;
}

.scanner-file-name {
  font-size: 1rem;
  font-weight: 600;
  color: var(--font-color);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

.scanner-file-size {
  font-size: 0.8125rem;
  color: var(--font-color-disabled);
  font-weight: 400;
  text-transform: uppercase;
  letter-spacing: 0.02em;
}

.scanner-clear-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  background: transparent;
  border: none;
  border-radius: var(--card-border-radius-medium);
  color: var(--font-color-disabled);
  cursor: pointer;
  flex-shrink: 0;
}

.scanner-clear-btn:focus {
  outline: none;
}

.scanner-clear-btn:focus-visible {
  outline: 2px solid var(--primary);
  outline-offset: 2px;
}

/* ========================================
   Multi-File List
   ======================================== */

.scanner-file-list {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-small);
}

.scanner-file-list-actions {
  display: flex;
  justify-content: center;
}

.scanner-add-more-btn {
  background: none;
  border: none;
  color: var(--primary);
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  padding: var(--spacing-xsmall) var(--spacing-small);
  border-radius: var(--card-border-radius-medium);
  transition: background 0.2s;
}

.scanner-add-more-btn:hover {
  background: var(--primary-50);
}

[data-theme="dark"] .scanner-add-more-btn:hover {
  background: var(--primary-900);
}

/* ========================================
   Extract Button
   ======================================== */

.scanner-extract-btn {
  width: 100%;
}

/* ========================================
   Processing State
   ======================================== */

.scanner-processing-state {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--spacing-xxlarge) var(--spacing-xlarge);
}

.scanner-processing-text {
  font-size: 1rem;
  color: var(--grey-500);
  margin: 0;
}

/* ========================================
   Results State
   ======================================== */

.scanner-results-state {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-medium);
  width: 100%;
}

/* Metadata bar */
.scanner-result-meta {
  display: flex;
  align-items: center;
  gap: var(--spacing-small);
  padding: var(--spacing-small) 0;
}

.scanner-meta-item {
  font-size: 0.8125rem;
  font-weight: 500;
  color: var(--grey-500);
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.scanner-meta-divider {
  color: var(--font-color-disabled);
  font-size: 0.75rem;
}

/* DisplaySection container styling */
.scanner-results-state .display-container {
  background: var(--background-color);
  border: var(--border-subtle);
  border-radius: var(--card-border-radius-large);
  overflow: hidden;
}

.scanner-results-state .display-header {
  padding: var(--spacing-small) var(--spacing-medium);
  background: var(--background-color-alt);
  border-bottom: var(--border-subtle);
}

.scanner-results-state .display-content {
  padding: var(--spacing-medium);
  max-height: 75vh;
  overflow-y: auto;
}

/* Scrollbar styling */
.scanner-results-state .display-content::-webkit-scrollbar {
  width: 6px;
}

.scanner-results-state .display-content::-webkit-scrollbar-track {
  background: transparent;
}

.scanner-results-state .display-content::-webkit-scrollbar-thumb {
  background: var(--grey-300);
  border-radius: 3px;
}

.scanner-results-state .display-content::-webkit-scrollbar-thumb:hover {
  background: var(--font-color-disabled);
}

/* ========================================
   Edit Form (UniversalEditForm)
   ======================================== */

.scanner-results-state .universal-edit-form {
  margin-top: var(--spacing-medium);
  border: var(--border-subtle);
  border-radius: var(--card-border-radius-large);
}

@media (max-width: 768px) {
  .scanner-results-state .universal-edit-form {
    position: fixed;
    inset: 0;
    z-index: 1000;
    margin-top: 0;
    border: none;
    border-radius: 0;
  }
}

/* ========================================
   Error Display
   ======================================== */

.scanner-error {
  margin: 0;
  border-radius: var(--card-border-radius-large);
}

/* ========================================
   Accessibility - Reduced Motion
   ======================================== */

@media (prefers-reduced-motion: reduce) {
  .scanner-upload-icon-circle {
    transition: none;
  }

  /* Disable all motion animations */
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* ========================================
   Mobile Responsive
   ======================================== */

/* ========================================
   Page Header
   ======================================== */

.scanner-page-header {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  gap: var(--spacing-xsmall);
  padding-bottom: var(--spacing-large);
  width: 100%;
}

/* Tab Content Wrapper */
.scanner-tab-content {
  width: 100%;
  max-width: 640px;
  margin: 0 auto;
  padding: var(--spacing-large) var(--spacing-medium);
  flex: 1;
  align-content: center;
}

/* Expand container when results are showing for side-by-side layout */
.scanner-tab-content:has(.scanner-results-state) {
  max-width: 840px;
}

/* ========================================
   Transform Panel (results layout)
   ======================================== */

.scanner-results-layout {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: var(--spacing-medium);
  align-items: start;
}

.scanner-results-main {
  min-width: 0;
}

.scanner-transform-panel {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-small);
  position: sticky;
  top: var(--spacing-medium);
}

.scanner-transform-btn {
  display: flex;
  align-items: center;
  gap: var(--spacing-small);
  padding: var(--spacing-small) var(--spacing-medium);
  background: var(--background-color);
  border: var(--border-subtle);
  border-radius: var(--card-border-radius-medium);
  color: var(--font-color);
  cursor: pointer;
  font-size: 0.875rem;
  white-space: nowrap;
  transition: border-color 0.2s, background 0.2s;
}

.scanner-transform-btn:hover:not(:disabled) {
  border-color: var(--primary);
  background: var(--primary-50);
}

[data-theme="dark"] .scanner-transform-btn:hover:not(:disabled) {
  background: var(--primary-900);
}

.scanner-transform-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* ========================================
   Mobile Responsive
   ======================================== */

@media (max-width: 768px) {
  .scanner-zen-title {
    font-size: 2rem;
  }

  .scanner-zen-subtitle {
    font-size: 1rem;
  }

  .scanner-upload-zone {
    padding: 48px 32px;
    border-radius: 16px;
  }

  .scanner-upload-icon,
  .scanner-upload-icon-circle {
    width: 64px;
    height: 64px;
  }

  .scanner-upload-icon svg {
    width: 32px;
    height: 32px;
  }

  .scanner-upload-text {
    font-size: 1rem;
  }

  .scanner-selected-file {
    padding: var(--spacing-small) var(--spacing-medium);
  }

  .scanner-file-icon {
    width: 48px;
    height: 48px;
  }

  .scanner-file-icon svg {
    width: 28px;
    height: 28px;
  }

  .scanner-result-header {
    flex-direction: column;
    gap: var(--spacing-small);
    align-items: flex-start;
  }

  .scanner-copy-btn {
    width: 100%;
    justify-content: center;
  }

  .scanner-result-content {
    max-height: 45vh;
    padding: var(--spacing-medium);
  }

  .scanner-processing-state {
    padding: var(--spacing-xlarge) var(--spacing-medium);
  }

  /* Reset expanded width on mobile */
  .scanner-tab-content:has(.scanner-results-state) {
    max-width: 640px;
  }

  .scanner-results-layout {
    grid-template-columns: 1fr;
  }

  .scanner-transform-panel {
    flex-direction: row;
    flex-wrap: wrap;
    position: static;
  }
}

@media (max-width: 480px) {
  .scanner-upload-zone {
    padding: 40px 24px;
    border-radius: 12px;
  }
}

/* ========================================
   Mobile Camera Actions
   ======================================== */

.scanner-mobile-actions {
  display: flex;
  gap: var(--spacing-medium);
  justify-content: center;
  padding: 48px 24px;
}

.scanner-mobile-action-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-small);
  width: 140px;
  height: 140px;
  background: var(--background-color);
  border: var(--border-subtle);
  border-radius: var(--card-border-radius-large);
  color: var(--font-color);
  cursor: pointer;
  transition: border-color 0.2s, background 0.2s;
  -webkit-tap-highlight-color: transparent;
}

.scanner-mobile-action-btn:active {
  background: var(--primary-50);
  border-color: var(--primary);
}

[data-theme="dark"] .scanner-mobile-action-btn:active {
  background: var(--primary-900);
}

.scanner-mobile-action-label {
  font-size: 0.9375rem;
  font-weight: 500;
}

/* ========================================
   Camera Overlay
   ======================================== */

.scanner-camera-overlay {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: #000;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.scanner-camera-close-btn {
  position: absolute;
  top: max(16px, env(safe-area-inset-top, 16px));
  right: 16px;
  z-index: 10;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 44px;
  height: 44px;
  background: rgba(0, 0, 0, 0.5);
  border: none;
  border-radius: 50%;
  color: #fff;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
}

.scanner-camera-loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--spacing-medium);
  color: #fff;
}

.scanner-camera-loading p {
  font-size: 1rem;
  margin: 0;
  opacity: 0.8;
}

.scanner-camera-spinner {
  width: 40px;
  height: 40px;
  border: 3px solid rgba(255, 255, 255, 0.2);
  border-top-color: #fff;
  border-radius: 50%;
  animation: scanner-spin 0.8s linear infinite;
}

@keyframes scanner-spin {
  to { transform: rotate(360deg); }
}

.scanner-camera-fallback-btn {
  padding: var(--spacing-small) var(--spacing-large);
  background: rgba(255, 255, 255, 0.15);
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: var(--card-border-radius-medium);
  color: #fff;
  font-size: 0.9375rem;
  cursor: pointer;
}

.scanner-camera-viewfinder {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.scanner-camera-video {
  width: 100%;
  height: 100%;
  object-fit: cover;
}


.scanner-camera-controls {
  position: absolute;
  bottom: max(32px, env(safe-area-inset-bottom, 32px));
  left: 0;
  right: 0;
  display: flex;
  justify-content: center;
  z-index: 10;
}

.scanner-camera-capture-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 72px;
  height: 72px;
  background: #fff;
  border: 4px solid rgba(255, 255, 255, 0.5);
  border-radius: 50%;
  color: var(--primary, #46962b);
  cursor: pointer;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  -webkit-tap-highlight-color: transparent;
  transition: transform 0.15s;
}

.scanner-camera-capture-btn:active {
  transform: scale(0.9);
}

