import{b as F,c as M,j as e,P as c,H as T}from"./index-DyXXXUoc.js";import{b as p,u as P,e as S}from"./vendor-CPnJIadx.js";import{b as y,c as A,d as D,a as m,e as z,f as R,g as B,h as U,i as W,I as q}from"./index-CqWIjGOL.js";var G=function(i){p.useEffect(i,[])},H=function(i){var r=p.useRef(i);r.current=i,G(function(){return function(){return r.current()}})};const K=({analysis:i,sourceRecommendations:r=[],unusedSources:d=[]})=>{let n=i;n&&(n=n.replace(/<ul[^>]*>([\s\S]*?)<\/ul>/g,s=>s.replace(/\n/g,"{{NEWLINE}}")).replace(/<ol[^>]*>([\s\S]*?)<\/ol>/g,s=>s.replace(/\n/g,"{{NEWLINE}}")),n=n.replace(/<h1[^>]*>(.*?)<\/h1>/g,"<p>&nbsp;</p><p><strong>$1</strong></p>").replace(/<h2[^>]*>(.*?)<\/h2>/g,"<p>&nbsp;</p><p><strong>$1</strong></p>").replace(/<h3[^>]*>(.*?)<\/h3>/g,"<p>&nbsp;</p><p><strong>$1</strong></p>").replace(/<h4[^>]*>(.*?)<\/h4>/g,"<p>&nbsp;</p><p><strong>$1</strong></p>").replace(/<h5[^>]*>(.*?)<\/h5>/g,"<p>&nbsp;</p><p><strong>$1</strong></p>").replace(/<h6[^>]*>(.*?)<\/h6>/g,"<p>&nbsp;</p><p><strong>$1</strong></p>"),n=n.replace(/\n\s*\n\s*\n/g,`

`).replace(/(?:\r\n|\r|\n)/g,`<br>
`).replace(/(<br>\n){2,}/g,"</p><p>").replace(/^(?!<p>)(.+)$/s,"<p>$1</p>").replace(/(<p>\s*(&nbsp;)?\s*<\/p>\s*){2,}/g,"<p>&nbsp;</p>"),n=n.replace(/{{NEWLINE}}/g,`
`),n=n.replace(/<\/div><div/g,"</div><p>&nbsp;</p><div").replace(/<\/ul><p>/g,"</ul><p>&nbsp;</p><p>").replace(/<\/ol><p>/g,"</ol><p>&nbsp;</p><p>").replace(/(<p>\s*(&nbsp;)?\s*<\/p>\s*){2,}/g,"<p>&nbsp;</p>")),(r==null?void 0:r.length)>0&&(n+="<p>&nbsp;</p>",n+='<div class="sources-section">',n+="<p>&nbsp;</p><p><strong>QUELLEN</strong></p>",r.forEach(s=>{const l=d.find(u=>u.title===s.title);n+='<div class="source-item">',n+=`<p><strong>${s.title}</strong></p>`,l!=null&&l.url&&(n+=`<p><a href="${l.url}">${l.url}</a></p>`),n+=`<p>${s.summary}</p>`,n+="</div>"}),n+="</div>");const o=d.slice(6);return o.length>0&&(n+="<p>&nbsp;</p>",n+='<div class="additional-sources-section">',n+="<p>&nbsp;</p><p><strong>ERGÄNZENDE QUELLEN</strong></p>",o.forEach(s=>{n+='<div class="source-item">',n+=`<p><strong>${s.title}</strong></p>`,n+=`<p><a href="${s.url}">${s.url}</a></p>`,n+="</div>"}),n+="</div>"),n=n.replace(/(<p>\s*(&nbsp;)?\s*<\/p>\s*){2,}/g,"<p>&nbsp;</p>").replace(/^(<p>\s*(&nbsp;)?\s*<\/p>\s*)+/,"").replace(/(<p>\s*(&nbsp;)?\s*<\/p>\s*)+$/,""),n},L=({content:i})=>{const r=P(),[d,n]=p.useState(!1),[o,s]=p.useState(""),[l,u]=p.useState(!1),{submitForm:x,loading:b,error:h}=F("etherpad/create"),{value:j}=p.useContext(M),[g,E]=p.useState(!1),I=j||i;H(()=>{u(!1),s("")});const a=(()=>{const t=r.pathname;return t.includes("pressemitteilung")?"Pressemitteilung":t.includes("antrag")?"Antrag":t.includes("anfrage")?"Anfrage":t.includes("social")?"Social Media Post":t.includes("rede")?"Rede":"Dokument"})(),$=()=>{o&&u(!0),n(!0)},k=async()=>{try{const t=K({analysis:j||I}),f=await x({text:t,documentType:a});if(f&&f.padURL)s(f.padURL);else throw new Error("Keine gültige Docs-URL erhalten")}catch(t){console.error("Fehler beim Exportieren zu Grünerator Docs:",t)}},w=async()=>{u(!1),s(""),await k()},N=()=>{navigator.clipboard.writeText(o).then(()=>{E(!0),setTimeout(()=>E(!1),2e3)}).catch(t=>{console.error("Fehler beim Kopieren des Docs-Links:",t)})},C=()=>{window.open(o,"_blank")},v=()=>{n(!1)},O=()=>S.createPortal(e.jsx("div",{className:"modal",role:"dialog","aria-labelledby":"export-modal-title",onClick:v,children:e.jsxs("div",{className:"modal-content",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{className:"close-button",onClick:v,children:e.jsx(A,{size:24})}),e.jsx("h2",{id:"export-modal-title",children:"Mit Grünerator Docs freigeben"}),l?e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["Für ",a==="Antrag"||a==="Social Media Post"?"diesen":"diese"," ",a," existiert bereits ein Link zur gemeinsamen Bearbeitung:"]}),e.jsxs("div",{className:"url-container",children:[e.jsx("input",{type:"text",value:o,readOnly:!0,className:"url-input"}),e.jsx("button",{onClick:N,className:`copy-docs-link-button ${g?"copied":""}`,children:g?e.jsx(D,{size:20}):e.jsx(m,{size:20})})]}),e.jsxs("div",{className:"button-group",children:[e.jsxs("button",{onClick:C,className:"open-button",children:[e.jsx(z,{size:20})," Bestehendes Dokument öffnen"]}),e.jsxs("button",{onClick:w,className:"export-action-button",children:[e.jsx(y,{size:20})," Als neues Dokument exportieren"]})]})]}):e.jsx(e.Fragment,{children:o?e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[a==="Antrag"||a==="Social Media Post"?"Dein":"Deine"," ",a," wurde erfolgreich freigegeben. Hier ist dein Link:"]}),e.jsxs("div",{className:"url-container",children:[e.jsx("input",{type:"text",value:o,readOnly:!0,className:"url-input"}),e.jsx("button",{onClick:N,className:`copy-docs-link-button ${g?"copied":""}`,children:g?e.jsx(D,{size:20}):e.jsx(m,{size:20})})]}),e.jsxs("button",{onClick:C,className:"open-button",children:[e.jsx(z,{size:20})," Link öffnen"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["Möchtest du ",a==="Antrag"||a==="Social Media Post"?"diesen":"diese"," ",a," mit anderen gemeinsam bearbeiten?"]}),e.jsxs("div",{className:"explanation-box",children:[e.jsx("p",{children:"Mit Grünerator Docs kannst du:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx(R,{size:18}),e.jsx("span",{children:"Texte in Echtzeit gemeinsam bearbeiten"})]}),e.jsxs("li",{children:[e.jsx(B,{size:18}),e.jsx("span",{children:"Änderungen sofort für alle sichtbar machen"})]}),e.jsxs("li",{children:[e.jsx(U,{size:18}),e.jsx("span",{children:"Einfach per Link zusammenarbeiten"})]})]}),e.jsx("div",{className:"info-note",children:e.jsx("p",{children:"Hinweis: Der Link ist öffentlich, enthält aber einen Sicherheitsschlüssel und ist schwer zu erraten. Teile ihn dennoch nur mit Personen, denen du vertraust."})})]}),e.jsx("button",{onClick:k,disabled:b,className:"export-action-button",children:b?"Wird exportiert...":"Jetzt freigeben"})]})}),h&&e.jsx("p",{className:"error-message",role:"alert",children:h})]})}),document.body);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:$,className:"action-button","aria-label":"Als Dokument exportieren","data-tooltip-id":"action-tooltip","data-tooltip-content":"Docs Export",children:e.jsx(y,{size:16})}),d&&e.jsx(O,{})]})};L.propTypes={content:c.string.isRequired};const Q=({content:i,onEdit:r,isEditing:d,allowEditing:n=!0,hideEditButton:o=!1,className:s="display-actions",showExport:l=!1})=>{const[u,x]=p.useState(e.jsx(m,{size:16})),b=()=>{T(i,()=>{x(e.jsx(q,{size:16})),setTimeout(()=>{x(e.jsx(m,{size:16}))},2e3)},()=>{})},h=window.innerWidth<=768;return e.jsx("div",{className:s,children:i&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:b,className:"action-button","aria-label":"Kopieren",...!h&&{"data-tooltip-id":"action-tooltip","data-tooltip-content":"Kopieren"},children:u}),l&&e.jsx(L,{content:i}),n&&!o&&e.jsx("button",{onClick:r,className:"action-button","aria-label":d?"Bearbeiten beenden":"Bearbeiten",...!h&&{"data-tooltip-id":"action-tooltip","data-tooltip-content":d?"Bearbeiten beenden":"Bearbeiten"},children:e.jsx(W,{size:16})})]})})};Q.propTypes={content:c.string.isRequired,onEdit:c.func.isRequired,isEditing:c.bool.isRequired,allowEditing:c.bool,hideEditButton:c.bool,className:c.string,showExport:c.bool};export{Q as A,K as f};
